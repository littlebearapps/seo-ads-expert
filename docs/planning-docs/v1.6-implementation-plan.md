# v1.6 Implementation Plan - Microsoft Ads Parity + Edge Store Optimization

## Executive Summary

**Goal**: Expand reach to Edge/Bing users through Microsoft Advertising integration and optimize Edge Add-ons Store listings based on search demand data.

**Timeline**: 4-6 days
**Priority**: MEDIUM-HIGH - Captures 10-15% additional market share
**Complexity**: Medium (format mapping, store optimization)

## Core Deliverables

### 1. Microsoft Ads Export System
- **msads_editor/** directory with complete bulk import CSVs
- **Field mapping guide** from Google Ads to Microsoft Advertising
- **Automated translation** of campaigns, ad groups, keywords, RSAs

### 2. Edge Store Optimization
- **edge_store_audit.md**: Keyword-aligned recommendations
- **Title/description variants** based on search data
- **Keyword optimization** for store discoverability

### 3. Cross-Platform Management
- **Unified reporting** across Google and Microsoft
- **Budget allocation** recommendations
- **Performance comparison** dashboards

## Technical Architecture

### Phase 1: Microsoft Ads Format Analysis (Day 1)

#### Task 1.1: Format Mapping Research
```typescript
// src/connectors/microsoft-ads-mapper.ts
export interface FieldMapping {
  googleField: string;
  microsoftField: string;
  transformer?: (value: any) => any;
  notes?: string;
}

export class MicrosoftAdsMapper {
  private fieldMappings: Map<string, FieldMapping> = new Map([
    // Campaign mappings
    ['Campaign', { googleField: 'Campaign', microsoftField: 'Campaign', notes: 'Direct mapping' }],
    ['Budget', { googleField: 'Budget', microsoftField: 'Budget', transformer: this.convertBudget }],
    ['Campaign Status', { googleField: 'Campaign status', microsoftField: 'Campaign Status' }],
    
    // Ad group mappings
    ['Ad Group', { googleField: 'Ad group', microsoftField: 'Ad Group' }],
    ['Max CPC', { googleField: 'Max. CPC', microsoftField: 'Bid', transformer: this.convertBid }],
    
    // Keyword mappings
    ['Keyword', { googleField: 'Keyword', microsoftField: 'Keyword' }],
    ['Match Type', { googleField: 'Match type', microsoftField: 'Match Type', notes: 'Broad off by default' }],
    
    // RSA mappings
    ['Headlines', { googleField: 'Headlines', microsoftField: 'Title Part 1-15', transformer: this.convertHeadlines }],
    ['Descriptions', { googleField: 'Descriptions', microsoftField: 'Text Part 1-4', transformer: this.convertDescriptions }],
    ['Pinning', { googleField: 'Pin to position', microsoftField: 'Title Part Position', transformer: this.convertPinning }]
  ]);
  
  // Transform Google format to Microsoft format
  mapCampaign(googleCampaign: GoogleCampaign): MicrosoftCampaign
  mapAdGroup(googleAdGroup: GoogleAdGroup): MicrosoftAdGroup
  mapKeyword(googleKeyword: GoogleKeyword): MicrosoftKeyword
  mapRSA(googleRSA: GoogleRSA): MicrosoftRSA
}
```

#### Task 1.2: Tracking Template Conversion
```typescript
// src/converters/tracking-template-converter.ts
export class TrackingTemplateConverter {
  // Convert Google ValueTrack to Microsoft parameters
  convertValueTrack(googleTemplate: string): string {
    return googleTemplate
      .replace('{campaignid}', '{CampaignId}')
      .replace('{adgroupid}', '{AdGroupId}')
      .replace('{keyword}', '{QueryString}')
      .replace('{device}', '{Device}')
      .replace('{network}', '{Network}')
      .replace('{creative}', '{AdId}');
  }
  
  // Generate Microsoft-specific UTM parameters
  generateMicrosoftUTM(baseUrl: string): string {
    return `${baseUrl}?utm_source=bing&utm_medium=cpc&utm_campaign={CampaignName}&utm_term={QueryString}&utm_content={AdId}`;
  }
}
```

### Phase 2: Microsoft Ads Export Writers (Day 2)

#### Task 2.1: Campaign & Budget Export
```typescript
// src/writers/microsoft/campaigns-writer.ts
export class MicrosoftCampaignsWriter {
  generateCampaignsCSV(campaigns: Campaign[]): string {
    // Microsoft bulk format columns
    const headers = [
      'Type', 'Status', 'Campaign', 'Budget', 'Budget Type',
      'Bid Strategy Type', 'Campaign Type', 'Priority',
      'Time Zone', 'Language', 'Location', 'Location Type'
    ];
    
    // Transform and write campaigns
    return this.writeCSV(headers, campaigns.map(c => this.transformCampaign(c)));
  }
  
  private transformCampaign(campaign: Campaign): MicrosoftCampaignRow {
    return {
      Type: 'Campaign',
      Status: 'Active',
      Campaign: campaign.name,
      Budget: campaign.dailyBudget,
      'Budget Type': 'DailyBudgetStandard',
      'Bid Strategy Type': 'ManualCpc',
      'Campaign Type': 'Search',
      Priority: 'Medium',
      'Time Zone': 'PacificTimeUSCanadaTijuana',
      Language: 'English',
      Location: this.mapLocations(campaign.markets),
      'Location Type': 'Location'
    };
  }
}
```

#### Task 2.2: Ad Groups & Keywords Export
```typescript
// src/writers/microsoft/adgroups-keywords-writer.ts
export class MicrosoftAdGroupsKeywordsWriter {
  generateAdGroupsCSV(adGroups: AdGroup[]): string {
    const headers = [
      'Type', 'Status', 'Campaign', 'Ad Group',
      'Search Network', 'Content Network', 'Search Bid',
      'Content Bid', 'Network Distribution', 'Pricing Model'
    ];
    
    return this.writeCSV(headers, adGroups.map(ag => this.transformAdGroup(ag)));
  }
  
  generateKeywordsCSV(keywords: Keyword[]): string {
    const headers = [
      'Type', 'Status', 'Campaign', 'Ad Group',
      'Keyword', 'Match Type', 'Bid', 'Param1',
      'Param2', 'Param3', 'Final Url', 'Tracking Template'
    ];
    
    // Split by match type for Microsoft preferences
    const exactKeywords = keywords.filter(k => k.matchType === 'EXACT');
    const phraseKeywords = keywords.filter(k => k.matchType === 'PHRASE');
    
    return {
      exact: this.writeCSV(headers, exactKeywords.map(k => this.transformKeyword(k))),
      phrase: this.writeCSV(headers, phraseKeywords.map(k => this.transformKeyword(k)))
    };
  }
}
```

#### Task 2.3: RSA Export with Asset Mapping
```typescript
// src/writers/microsoft/rsa-writer.ts
export class MicrosoftRSAWriter {
  generateRSACSV(ads: ResponsiveSearchAd[]): string {
    const headers = [
      'Type', 'Status', 'Campaign', 'Ad Group', 'Ad Type',
      'Title Part 1', 'Title Part 2', 'Title Part 3', '...Title Part 15',
      'Title Part 1 Position', '...Title Part 15 Position',
      'Text Part 1', 'Text Part 2', 'Text Part 3', 'Text Part 4',
      'Text Part 1 Position', '...Text Part 4 Position',
      'Path 1', 'Path 2', 'Final Url', 'Tracking Template'
    ];
    
    return this.writeCSV(headers, ads.map(ad => this.transformRSA(ad)));
  }
  
  private transformRSA(ad: ResponsiveSearchAd): MicrosoftRSARow {
    const row: any = {
      Type: 'Responsive search ad',
      Status: 'Active',
      Campaign: ad.campaignName,
      'Ad Group': ad.adGroupName,
      'Ad Type': 'ResponsiveSearchAd'
    };
    
    // Map headlines (up to 15)
    ad.headlines.forEach((headline, i) => {
      row[`Title Part ${i + 1}`] = headline.text;
      if (headline.pinning) {
        row[`Title Part ${i + 1} Position`] = this.mapPinning(headline.pinning);
      }
    });
    
    // Map descriptions (up to 4)
    ad.descriptions.forEach((desc, i) => {
      row[`Text Part ${i + 1}`] = desc.text;
      if (desc.pinning) {
        row[`Text Part ${i + 1} Position`] = this.mapPinning(desc.pinning);
      }
    });
    
    return row;
  }
}
```

#### Task 2.4: Extensions & Negative Keywords
```typescript
// src/writers/microsoft/extensions-negatives-writer.ts
export class MicrosoftExtensionsNegativesWriter {
  // Sitelinks
  generateSitelinksCSV(sitelinks: Sitelink[]): string {
    const headers = [
      'Type', 'Campaign', 'Ad Group', 'Sitelink Extension Order',
      'Sitelink Extension Link Text', 'Sitelink Extension Final Url',
      'Sitelink Extension Description1', 'Sitelink Extension Description2'
    ];
    
    return this.writeCSV(headers, sitelinks.map(sl => this.transformSitelink(sl)));
  }
  
  // Shared negative lists
  generateSharedNegativesCSV(negatives: NegativeKeyword[]): string {
    const headers = [
      'Type', 'Status', 'Negative Keyword List', 'Keyword', 'Match Type'
    ];
    
    // Group by product for shared lists
    const sharedLists = this.groupNegativesByProduct(negatives);
    
    return this.writeCSV(headers, sharedLists);
  }
  
  // List associations
  generateAssociationsCSV(associations: ListAssociation[]): string {
    const headers = [
      'Type', 'Status', 'Campaign', 'Negative Keyword List'
    ];
    
    return this.writeCSV(headers, associations.map(a => this.transformAssociation(a)));
  }
}
```

### Phase 3: Edge Store Optimization (Day 3)

#### Task 3.1: Store Listing Analyzer
```typescript
// src/analyzers/edge-store-analyzer.ts
export interface EdgeStoreListing {
  name: string;
  shortDescription: string;
  detailedDescription: string;
  keywords: string[];
  category: string;
  screenshots: Screenshot[];
  video?: string;
}

export class EdgeStoreAnalyzer {
  // Analyze current listing
  async analyzeListing(
    currentListing: EdgeStoreListing,
    searchData: KeywordData[]
  ): StoreAnalysis {
    return {
      titleOptimization: this.optimizeTitle(currentListing.name, searchData),
      descriptionVariants: this.generateDescriptionVariants(currentListing, searchData),
      keywordRecommendations: this.recommendKeywords(currentListing.keywords, searchData),
      missingAssets: this.checkAssets(currentListing)
    };
  }
  
  // Title optimization (â‰¤45 chars)
  private optimizeTitle(
    currentTitle: string,
    searchData: KeywordData[]
  ): TitleRecommendation[] {
    const topKeyword = this.findTopPerformingKeyword(searchData);
    
    return [
      {
        title: `${currentTitle} â€“ ${topKeyword}`,
        reasoning: 'Include top search term',
        characterCount: currentTitle.length + topKeyword.length + 3
      },
      {
        title: `${topKeyword} Extension for Edge`,
        reasoning: 'Lead with keyword',
        characterCount: topKeyword.length + 19
      }
    ];
  }
  
  // Description variants
  private generateDescriptionVariants(
    listing: EdgeStoreListing,
    searchData: KeywordData[]
  ): DescriptionVariant[] {
    const topUseCases = this.extractTopUseCases(searchData);
    
    return [
      {
        type: 'benefit-led',
        short: this.generateBenefitShortDesc(topUseCases[0]),
        detailed: this.generateBenefitDetailedDesc(topUseCases)
      },
      {
        type: 'feature-led',
        short: this.generateFeatureShortDesc(listing),
        detailed: this.generateFeatureDetailedDesc(listing)
      }
    ];
  }
}
```

#### Task 3.2: Store Audit Report Writer
```typescript
// src/writers/edge-store-audit-writer.ts
export class EdgeStoreAuditWriter {
  generateAuditReport(
    product: string,
    analysis: StoreAnalysis
  ): string {
    return `# Edge Add-ons Store Audit - ${product}

## ðŸ“ Title Optimization

### Current Title
${analysis.currentTitle} (${analysis.currentTitle.length} chars)

### Recommended Titles
${analysis.titleOptimization.map((rec, i) => `
${i + 1}. **${rec.title}** (${rec.characterCount} chars)
   - Reasoning: ${rec.reasoning}
   - Keywords included: ${rec.keywords.join(', ')}
`).join('')}

## ðŸ“„ Description Variants

### Short Description (A/B Test Candidates)

#### Variant A: Benefit-Led
> ${analysis.descriptionVariants[0].short}

#### Variant B: Feature-Led
> ${analysis.descriptionVariants[1].short}

### Detailed Description Structure

${analysis.detailedDescriptionOutline}

## ðŸ”‘ Keyword Recommendations

### Current Keywords
${analysis.currentKeywords.join(', ')}

### Recommended Additions
${analysis.keywordRecommendations.map(k => `- **${k.keyword}** (${k.volume} searches/month)`).join('\n')}

### Keywords to Remove
${analysis.keywordsToRemove.map(k => `- ~~${k}~~ (low relevance)`).join('\n')}

## ðŸ–¼ï¸ Asset Checklist

${analysis.assetChecklist.map(item => `- [${item.present ? 'x' : ' '}] ${item.asset}: ${item.recommendation}`).join('\n')}

## ðŸ“Š Competitive Analysis

${analysis.competitorComparison}

## ðŸŽ¯ Action Items

1. ${analysis.prioritizedActions.join('\n2. ')}

## ðŸ“ˆ Expected Impact

- **Discoverability**: +${analysis.expectedDiscoverabilityLift}%
- **CTR from Store**: +${analysis.expectedCTRLift}%
- **Install Rate**: +${analysis.expectedInstallLift}%
`;
  }
}
```

### Phase 4: Geo & Language Mapping (Day 3-4)

#### Task 4.1: Market Configuration
```typescript
// src/config/microsoft-markets.ts
export class MicrosoftMarketMapper {
  private marketMappings = new Map([
    ['AU', { location: 'Australia', language: 'English', timeZone: 'AusSydney' }],
    ['US', { location: 'United States', language: 'English', timeZone: 'PacificTimeUSCanadaTijuana' }],
    ['GB', { location: 'United Kingdom', language: 'English', timeZone: 'GMTDublinEdinburghLisbonLondon' }],
    ['CA', { location: 'Canada', language: 'English', timeZone: 'EasternTimeUSCanada' }],
    ['DE', { location: 'Germany', language: 'German', timeZone: 'WEuropeStandardTime' }],
    ['FR', { location: 'France', language: 'French', timeZone: 'RomanceStandardTime' }],
    ['ES', { location: 'Spain', language: 'Spanish', timeZone: 'RomanceStandardTime' }],
    ['IT', { location: 'Italy', language: 'Italian', timeZone: 'WEuropeStandardTime' }]
  ]);
  
  mapGoogleToMicrosoft(googleMarkets: string[]): MicrosoftMarket[]
  
  // Device adjustments (desktop-first for Edge)
  getDeviceModifiers(): DeviceModifier[] {
    return [
      { device: 'Computers', bidAdjustment: 0 },
      { device: 'Tablets', bidAdjustment: -50 },
      { device: 'Smartphones', bidAdjustment: -80 }
    ];
  }
}
```

### Phase 5: Validation & Testing (Day 4-5)

#### Task 5.1: Format Validator
```typescript
// src/validators/microsoft-format-validator.ts
export class MicrosoftFormatValidator {
  // Validate CSV structure
  validateCSVFormat(csvContent: string, type: string): ValidationResult {
    const headers = this.parseHeaders(csvContent);
    const requiredHeaders = this.getRequiredHeaders(type);
    
    return {
      valid: this.hasAllRequiredHeaders(headers, requiredHeaders),
      missingHeaders: this.findMissingHeaders(headers, requiredHeaders),
      extraHeaders: this.findExtraHeaders(headers, requiredHeaders),
      warnings: this.checkForCommonIssues(csvContent)
    };
  }
  
  // Validate field values
  validateFieldValues(rows: any[], type: string): FieldValidation[] {
    return rows.map(row => this.validateRow(row, type));
  }
  
  // Check for Microsoft-specific requirements
  checkMicrosoftRequirements(data: any): RequirementCheck[] {
    return [
      this.checkHeadlineCount(data), // Min 3, max 15
      this.checkDescriptionCount(data), // Min 2, max 4
      this.checkCharacterLimits(data),
      this.checkPinningRules(data),
      this.checkBudgetMinimums(data)
    ];
  }
}
```

#### Task 5.2: Diff Generator
```typescript
// src/utils/platform-diff.ts
export class PlatformDiffGenerator {
  // Compare Google vs Microsoft outputs
  generateDiff(
    googleExport: GoogleExport,
    microsoftExport: MicrosoftExport
  ): PlatformDiff {
    return {
      campaigns: this.compareCampaigns(googleExport.campaigns, microsoftExport.campaigns),
      adGroups: this.compareAdGroups(googleExport.adGroups, microsoftExport.adGroups),
      keywords: this.compareKeywords(googleExport.keywords, microsoftExport.keywords),
      ads: this.compareAds(googleExport.ads, microsoftExport.ads),
      summary: this.generateSummary()
    };
  }
  
  // Generate mapping documentation
  generateMappingDoc(): string {
    return this.documentFieldMappings() + 
           this.documentKnownDifferences() +
           this.documentWorkarounds();
  }
}
```

### Phase 6: CLI Integration (Day 5)

#### Task 6.1: Microsoft Ads Commands
```typescript
// src/cli-microsoft.ts
program
  .command('export-msads')
  .description('Export campaigns for Microsoft Advertising')
  .option('--product <product>', 'Product name')
  .option('--markets <markets>', 'Comma-separated market codes')
  .option('--source <path>', 'Source Google Ads export path')
  .option('--validate-only', 'Validate without exporting')
  .action(exportMicrosoftAdsCommand);

program
  .command('validate-msads')
  .description('Validate Microsoft Ads bulk files')
  .option('--path <path>', 'Path to Microsoft export directory')
  .option('--strict', 'Fail on warnings')
  .action(validateMicrosoftAdsCommand);

program
  .command('edge-store-audit')
  .description('Audit and optimize Edge Add-ons Store listing')
  .option('--product <product>', 'Product name')
  .option('--current-listing <path>', 'Current listing JSON')
  .option('--search-data <path>', 'Keyword performance data')
  .action(edgeStoreAuditCommand);

program
  .command('sync-platforms')
  .description('Sync changes between Google and Microsoft')
  .option('--product <product>', 'Product name')
  .option('--direction <dir>', 'google-to-microsoft|microsoft-to-google')
  .option('--dry-run', 'Preview changes without applying')
  .action(syncPlatformsCommand);
```

### Phase 7: Monitoring & Reporting (Day 6)

#### Task 7.1: Cross-Platform Dashboard
```typescript
// src/monitors/cross-platform-monitor.ts
export class CrossPlatformMonitor {
  // Unified metrics
  async getCrossPlatformMetrics(
    product: string,
    dateRange: DateRange
  ): CrossPlatformMetrics {
    const googleMetrics = await this.fetchGoogleMetrics(product, dateRange);
    const microsoftMetrics = await this.fetchMicrosoftMetrics(product, dateRange);
    
    return {
      combined: this.combineMetrics(googleMetrics, microsoftMetrics),
      google: googleMetrics,
      microsoft: microsoftMetrics,
      comparison: this.comparePerformance(googleMetrics, microsoftMetrics)
    };
  }
  
  // Platform-specific insights
  generateInsights(metrics: CrossPlatformMetrics): PlatformInsights {
    return {
      opportunities: this.findOpportunities(metrics),
      recommendations: this.generateRecommendations(metrics),
      budgetAllocation: this.optimizeBudgetAllocation(metrics)
    };
  }
}
```

## Database Schema

```sql
-- Microsoft Ads configuration
CREATE TABLE microsoft_ads_config (
  product TEXT PRIMARY KEY,
  customer_id TEXT,
  account_id TEXT,
  time_zone TEXT,
  currency TEXT,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Platform mapping
CREATE TABLE platform_field_mapping (
  entity_type TEXT,
  google_field TEXT,
  microsoft_field TEXT,
  transformation TEXT,
  notes TEXT,
  PRIMARY KEY (entity_type, google_field)
);

-- Edge store listings
CREATE TABLE edge_store_listings (
  product TEXT PRIMARY KEY,
  current_title TEXT,
  current_short_desc TEXT,
  current_keywords TEXT,
  optimized_title TEXT,
  optimized_short_desc TEXT,
  optimized_keywords TEXT,
  last_audit_date DATE,
  expected_lift REAL
);

-- Cross-platform metrics
CREATE TABLE cross_platform_metrics (
  date DATE,
  product TEXT,
  platform TEXT,
  impressions INTEGER,
  clicks INTEGER,
  cost REAL,
  conversions INTEGER,
  ctr REAL,
  cpc REAL,
  conv_rate REAL,
  PRIMARY KEY (date, product, platform)
);
```

## Testing Strategy

### Unit Tests
- Field mapping transformations
- CSV generation with correct headers
- Character limit validation
- Pinning rule conversions

### Integration Tests
- End-to-end export generation
- Format validation pipeline
- Cross-platform sync

### Manual Tests
- Import test files into Microsoft Ads sandbox
- Verify RSA asset mapping
- Check extension compatibility

## Risk Mitigation

### Technical Risks
1. **Format Changes**: Version lock, regression tests
2. **API Differences**: Abstraction layer, fallback strategies
3. **Data Loss**: Validation before export, rollback capability

### Business Risks
1. **Budget Overspend**: Conservative daily caps initially
2. **Poor Performance**: Start with proven Google winners
3. **Brand Consistency**: Shared approval workflow

## Success Metrics

### Week 1
- Successful import of 1 campaign
- No critical errors in Microsoft interface
- Edge store audit completed

### Month 1
- 10% of Google traffic matched on Bing
- 5% increase in Edge store installs
- ROI parity with Google Ads

### Quarter 1
- 15% incremental reach
- Microsoft-specific optimizations deployed
- Positive ROI on Microsoft spend

## Implementation Schedule

### Day 1: Research & Mapping
- [ ] Morning: Microsoft Ads format documentation
- [ ] Afternoon: Field mapping implementation
- [ ] Evening: Tracking template conversion

### Day 2: Export Writers
- [ ] Morning: Campaign and budget export
- [ ] Afternoon: Keywords and ad groups
- [ ] Evening: RSA asset mapping

### Day 3: Edge Store & Extensions
- [ ] Morning: Store listing analyzer
- [ ] Afternoon: Audit report writer
- [ ] Evening: Extensions and negatives

### Day 4: Validation & Markets
- [ ] Morning: Format validator
- [ ] Afternoon: Market/language mapping
- [ ] Evening: Integration tests

### Day 5: CLI & Testing
- [ ] Morning: CLI commands
- [ ] Afternoon: Manual testing with sandbox
- [ ] Evening: Bug fixes

### Day 6: Polish & Documentation
- [ ] Morning: Cross-platform monitoring
- [ ] Afternoon: User documentation
- [ ] Evening: Launch preparation

## Documentation Requirements

1. **Migration Guide**: Step-by-step Google â†’ Microsoft
2. **Field Mapping Reference**: Complete mapping table
3. **Edge Store Guide**: Optimization best practices
4. **Troubleshooting**: Common import errors

## Rollout Plan

### Week 1: Test Import
- Single product (ConvertMyFile)
- Manual import and verification
- Monitor for 48 hours

### Week 2: Gradual Rollout
- Add remaining products
- Automate daily sync
- A/B test Edge store changes

### Month 1: Optimization
- Platform-specific bid adjustments
- Microsoft-only keywords
- Edge store variant testing

## Future Enhancements

1. **Automated Sync**: Real-time campaign synchronization
2. **Microsoft-Specific Features**: Audience targeting, LinkedIn integration
3. **Store Intelligence**: Competitor store analysis
4. **Bing Webmaster**: SEO parity implementation
5. **Amazon Ads**: Expand to third platform

---

**Estimated Effort**: 4-6 days
**Complexity**: Medium
**ROI**: Medium-High (10-15% incremental reach)
**Risk**: Low (read-only exports, manual application)